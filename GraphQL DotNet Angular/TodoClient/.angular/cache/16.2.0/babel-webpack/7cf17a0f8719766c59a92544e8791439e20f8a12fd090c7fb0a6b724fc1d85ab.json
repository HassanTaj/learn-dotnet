{"ast":null,"code":"import { __assign, __extends } from \"tslib\";\nimport { invariant } from '../utilities/globals/index.js';\nimport { equal } from '@wry/equality';\nimport { NetworkStatus, isNetworkRequestInFlight } from './networkStatus.js';\nimport { cloneDeep, compact, getOperationDefinition, Observable, iterateObserversSafely, fixObservableSubclass, getQueryDefinition } from '../utilities/index.js';\nimport { equalByQuery } from './equalByQuery.js';\nvar assign = Object.assign,\n  hasOwnProperty = Object.hasOwnProperty;\nvar ObservableQuery = function (_super) {\n  __extends(ObservableQuery, _super);\n  function ObservableQuery(_a) {\n    var queryManager = _a.queryManager,\n      queryInfo = _a.queryInfo,\n      options = _a.options;\n    var _this = _super.call(this, function (observer) {\n      try {\n        var subObserver = observer._subscription._observer;\n        if (subObserver && !subObserver.error) {\n          subObserver.error = defaultSubscriptionObserverErrorCallback;\n        }\n      } catch (_a) {}\n      var first = !_this.observers.size;\n      _this.observers.add(observer);\n      var last = _this.last;\n      if (last && last.error) {\n        observer.error && observer.error(last.error);\n      } else if (last && last.result) {\n        observer.next && observer.next(last.result);\n      }\n      if (first) {\n        _this.reobserve().catch(function () {});\n      }\n      return function () {\n        if (_this.observers.delete(observer) && !_this.observers.size) {\n          _this.tearDownQuery();\n        }\n      };\n    }) || this;\n    _this.observers = new Set();\n    _this.subscriptions = new Set();\n    _this.queryInfo = queryInfo;\n    _this.queryManager = queryManager;\n    _this.waitForOwnResult = skipCacheDataFor(options.fetchPolicy);\n    _this.isTornDown = false;\n    var _b = queryManager.defaultOptions.watchQuery,\n      _c = _b === void 0 ? {} : _b,\n      _d = _c.fetchPolicy,\n      defaultFetchPolicy = _d === void 0 ? \"cache-first\" : _d;\n    var _e = options.fetchPolicy,\n      fetchPolicy = _e === void 0 ? defaultFetchPolicy : _e,\n      _f = options.initialFetchPolicy,\n      initialFetchPolicy = _f === void 0 ? fetchPolicy === \"standby\" ? defaultFetchPolicy : fetchPolicy : _f;\n    _this.options = __assign(__assign({}, options), {\n      initialFetchPolicy: initialFetchPolicy,\n      fetchPolicy: fetchPolicy\n    });\n    _this.queryId = queryInfo.queryId || queryManager.generateQueryId();\n    var opDef = getOperationDefinition(_this.query);\n    _this.queryName = opDef && opDef.name && opDef.name.value;\n    return _this;\n  }\n  Object.defineProperty(ObservableQuery.prototype, \"query\", {\n    get: function () {\n      return this.lastQuery || this.options.query;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ObservableQuery.prototype, \"variables\", {\n    get: function () {\n      return this.options.variables;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  ObservableQuery.prototype.result = function () {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      var observer = {\n        next: function (result) {\n          resolve(result);\n          _this.observers.delete(observer);\n          if (!_this.observers.size) {\n            _this.queryManager.removeQuery(_this.queryId);\n          }\n          setTimeout(function () {\n            subscription.unsubscribe();\n          }, 0);\n        },\n        error: reject\n      };\n      var subscription = _this.subscribe(observer);\n    });\n  };\n  ObservableQuery.prototype.getCurrentResult = function (saveAsLastResult) {\n    if (saveAsLastResult === void 0) {\n      saveAsLastResult = true;\n    }\n    var lastResult = this.getLastResult(true);\n    var networkStatus = this.queryInfo.networkStatus || lastResult && lastResult.networkStatus || NetworkStatus.ready;\n    var result = __assign(__assign({}, lastResult), {\n      loading: isNetworkRequestInFlight(networkStatus),\n      networkStatus: networkStatus\n    });\n    var _a = this.options.fetchPolicy,\n      fetchPolicy = _a === void 0 ? \"cache-first\" : _a;\n    if (skipCacheDataFor(fetchPolicy) || this.queryManager.getDocumentInfo(this.query).hasForcedResolvers) {} else if (this.waitForOwnResult) {\n      this.queryInfo['updateWatch']();\n    } else {\n      var diff = this.queryInfo.getDiff();\n      if (diff.complete || this.options.returnPartialData) {\n        result.data = diff.result;\n      }\n      if (equal(result.data, {})) {\n        result.data = void 0;\n      }\n      if (diff.complete) {\n        delete result.partial;\n        if (diff.complete && result.networkStatus === NetworkStatus.loading && (fetchPolicy === 'cache-first' || fetchPolicy === 'cache-only')) {\n          result.networkStatus = NetworkStatus.ready;\n          result.loading = false;\n        }\n      } else {\n        result.partial = true;\n      }\n      if (globalThis.__DEV__ !== false && !diff.complete && !this.options.partialRefetch && !result.loading && !result.data && !result.error) {\n        logMissingFieldErrors(diff.missing);\n      }\n    }\n    if (saveAsLastResult) {\n      this.updateLastResult(result);\n    }\n    return result;\n  };\n  ObservableQuery.prototype.isDifferentFromLastResult = function (newResult, variables) {\n    if (!this.last) {\n      return true;\n    }\n    var resultIsDifferent = this.queryManager.getDocumentInfo(this.query).hasNonreactiveDirective ? !equalByQuery(this.query, this.last.result, newResult, this.variables) : !equal(this.last.result, newResult);\n    return resultIsDifferent || variables && !equal(this.last.variables, variables);\n  };\n  ObservableQuery.prototype.getLast = function (key, variablesMustMatch) {\n    var last = this.last;\n    if (last && last[key] && (!variablesMustMatch || equal(last.variables, this.variables))) {\n      return last[key];\n    }\n  };\n  ObservableQuery.prototype.getLastResult = function (variablesMustMatch) {\n    return this.getLast(\"result\", variablesMustMatch);\n  };\n  ObservableQuery.prototype.getLastError = function (variablesMustMatch) {\n    return this.getLast(\"error\", variablesMustMatch);\n  };\n  ObservableQuery.prototype.resetLastResults = function () {\n    delete this.last;\n    this.isTornDown = false;\n  };\n  ObservableQuery.prototype.resetQueryStoreErrors = function () {\n    this.queryManager.resetErrors(this.queryId);\n  };\n  ObservableQuery.prototype.refetch = function (variables) {\n    var _a;\n    var reobserveOptions = {\n      pollInterval: 0\n    };\n    var fetchPolicy = this.options.fetchPolicy;\n    if (fetchPolicy === 'cache-and-network') {\n      reobserveOptions.fetchPolicy = fetchPolicy;\n    } else if (fetchPolicy === 'no-cache') {\n      reobserveOptions.fetchPolicy = 'no-cache';\n    } else {\n      reobserveOptions.fetchPolicy = 'network-only';\n    }\n    if (globalThis.__DEV__ !== false && variables && hasOwnProperty.call(variables, \"variables\")) {\n      var queryDef = getQueryDefinition(this.query);\n      var vars = queryDef.variableDefinitions;\n      if (!vars || !vars.some(function (v) {\n        return v.variable.name.value === \"variables\";\n      })) {\n        globalThis.__DEV__ !== false && invariant.warn(18, variables, ((_a = queryDef.name) === null || _a === void 0 ? void 0 : _a.value) || queryDef);\n      }\n    }\n    if (variables && !equal(this.options.variables, variables)) {\n      reobserveOptions.variables = this.options.variables = __assign(__assign({}, this.options.variables), variables);\n    }\n    this.queryInfo.resetLastWrite();\n    return this.reobserve(reobserveOptions, NetworkStatus.refetch);\n  };\n  ObservableQuery.prototype.fetchMore = function (fetchMoreOptions) {\n    var _this = this;\n    var combinedOptions = __assign(__assign({}, fetchMoreOptions.query ? fetchMoreOptions : __assign(__assign(__assign(__assign({}, this.options), {\n      query: this.options.query\n    }), fetchMoreOptions), {\n      variables: __assign(__assign({}, this.options.variables), fetchMoreOptions.variables)\n    })), {\n      fetchPolicy: \"no-cache\"\n    });\n    combinedOptions.query = this.transformDocument(combinedOptions.query);\n    var qid = this.queryManager.generateQueryId();\n    this.lastQuery = fetchMoreOptions.query ? this.transformDocument(this.options.query) : combinedOptions.query;\n    var queryInfo = this.queryInfo;\n    var originalNetworkStatus = queryInfo.networkStatus;\n    queryInfo.networkStatus = NetworkStatus.fetchMore;\n    if (combinedOptions.notifyOnNetworkStatusChange) {\n      this.observe();\n    }\n    var updatedQuerySet = new Set();\n    return this.queryManager.fetchQuery(qid, combinedOptions, NetworkStatus.fetchMore).then(function (fetchMoreResult) {\n      _this.queryManager.removeQuery(qid);\n      if (queryInfo.networkStatus === NetworkStatus.fetchMore) {\n        queryInfo.networkStatus = originalNetworkStatus;\n      }\n      _this.queryManager.cache.batch({\n        update: function (cache) {\n          var updateQuery = fetchMoreOptions.updateQuery;\n          if (updateQuery) {\n            cache.updateQuery({\n              query: _this.query,\n              variables: _this.variables,\n              returnPartialData: true,\n              optimistic: false\n            }, function (previous) {\n              return updateQuery(previous, {\n                fetchMoreResult: fetchMoreResult.data,\n                variables: combinedOptions.variables\n              });\n            });\n          } else {\n            cache.writeQuery({\n              query: combinedOptions.query,\n              variables: combinedOptions.variables,\n              data: fetchMoreResult.data\n            });\n          }\n        },\n        onWatchUpdated: function (watch) {\n          updatedQuerySet.add(watch.query);\n        }\n      });\n      return fetchMoreResult;\n    }).finally(function () {\n      if (!updatedQuerySet.has(_this.query)) {\n        reobserveCacheFirst(_this);\n      }\n    });\n  };\n  ObservableQuery.prototype.subscribeToMore = function (options) {\n    var _this = this;\n    var subscription = this.queryManager.startGraphQLSubscription({\n      query: options.document,\n      variables: options.variables,\n      context: options.context\n    }).subscribe({\n      next: function (subscriptionData) {\n        var updateQuery = options.updateQuery;\n        if (updateQuery) {\n          _this.updateQuery(function (previous, _a) {\n            var variables = _a.variables;\n            return updateQuery(previous, {\n              subscriptionData: subscriptionData,\n              variables: variables\n            });\n          });\n        }\n      },\n      error: function (err) {\n        if (options.onError) {\n          options.onError(err);\n          return;\n        }\n        globalThis.__DEV__ !== false && invariant.error(19, err);\n      }\n    });\n    this.subscriptions.add(subscription);\n    return function () {\n      if (_this.subscriptions.delete(subscription)) {\n        subscription.unsubscribe();\n      }\n    };\n  };\n  ObservableQuery.prototype.setOptions = function (newOptions) {\n    return this.reobserve(newOptions);\n  };\n  ObservableQuery.prototype.silentSetOptions = function (newOptions) {\n    var mergedOptions = compact(this.options, newOptions || {});\n    assign(this.options, mergedOptions);\n  };\n  ObservableQuery.prototype.setVariables = function (variables) {\n    if (equal(this.variables, variables)) {\n      return this.observers.size ? this.result() : Promise.resolve();\n    }\n    this.options.variables = variables;\n    if (!this.observers.size) {\n      return Promise.resolve();\n    }\n    return this.reobserve({\n      fetchPolicy: this.options.initialFetchPolicy,\n      variables: variables\n    }, NetworkStatus.setVariables);\n  };\n  ObservableQuery.prototype.updateQuery = function (mapFn) {\n    var queryManager = this.queryManager;\n    var result = queryManager.cache.diff({\n      query: this.options.query,\n      variables: this.variables,\n      returnPartialData: true,\n      optimistic: false\n    }).result;\n    var newResult = mapFn(result, {\n      variables: this.variables\n    });\n    if (newResult) {\n      queryManager.cache.writeQuery({\n        query: this.options.query,\n        data: newResult,\n        variables: this.variables\n      });\n      queryManager.broadcastQueries();\n    }\n  };\n  ObservableQuery.prototype.startPolling = function (pollInterval) {\n    this.options.pollInterval = pollInterval;\n    this.updatePolling();\n  };\n  ObservableQuery.prototype.stopPolling = function () {\n    this.options.pollInterval = 0;\n    this.updatePolling();\n  };\n  ObservableQuery.prototype.applyNextFetchPolicy = function (reason, options) {\n    if (options.nextFetchPolicy) {\n      var _a = options.fetchPolicy,\n        fetchPolicy = _a === void 0 ? \"cache-first\" : _a,\n        _b = options.initialFetchPolicy,\n        initialFetchPolicy = _b === void 0 ? fetchPolicy : _b;\n      if (fetchPolicy === \"standby\") {} else if (typeof options.nextFetchPolicy === \"function\") {\n        options.fetchPolicy = options.nextFetchPolicy(fetchPolicy, {\n          reason: reason,\n          options: options,\n          observable: this,\n          initialFetchPolicy: initialFetchPolicy\n        });\n      } else if (reason === \"variables-changed\") {\n        options.fetchPolicy = initialFetchPolicy;\n      } else {\n        options.fetchPolicy = options.nextFetchPolicy;\n      }\n    }\n    return options.fetchPolicy;\n  };\n  ObservableQuery.prototype.fetch = function (options, newNetworkStatus) {\n    this.queryManager.setObservableQuery(this);\n    return this.queryManager['fetchConcastWithInfo'](this.queryId, options, newNetworkStatus);\n  };\n  ObservableQuery.prototype.updatePolling = function () {\n    var _this = this;\n    if (this.queryManager.ssrMode) {\n      return;\n    }\n    var _a = this,\n      pollingInfo = _a.pollingInfo,\n      pollInterval = _a.options.pollInterval;\n    if (!pollInterval) {\n      if (pollingInfo) {\n        clearTimeout(pollingInfo.timeout);\n        delete this.pollingInfo;\n      }\n      return;\n    }\n    if (pollingInfo && pollingInfo.interval === pollInterval) {\n      return;\n    }\n    invariant(pollInterval, 20);\n    var info = pollingInfo || (this.pollingInfo = {});\n    info.interval = pollInterval;\n    var maybeFetch = function () {\n      if (_this.pollingInfo) {\n        if (!isNetworkRequestInFlight(_this.queryInfo.networkStatus)) {\n          _this.reobserve({\n            fetchPolicy: _this.options.initialFetchPolicy === 'no-cache' ? 'no-cache' : 'network-only'\n          }, NetworkStatus.poll).then(poll, poll);\n        } else {\n          poll();\n        }\n      }\n      ;\n    };\n    var poll = function () {\n      var info = _this.pollingInfo;\n      if (info) {\n        clearTimeout(info.timeout);\n        info.timeout = setTimeout(maybeFetch, info.interval);\n      }\n    };\n    poll();\n  };\n  ObservableQuery.prototype.updateLastResult = function (newResult, variables) {\n    if (variables === void 0) {\n      variables = this.variables;\n    }\n    var error = this.getLastError();\n    if (error && this.last && !equal(variables, this.last.variables)) {\n      error = void 0;\n    }\n    return this.last = __assign({\n      result: this.queryManager.assumeImmutableResults ? newResult : cloneDeep(newResult),\n      variables: variables\n    }, error ? {\n      error: error\n    } : null);\n  };\n  ObservableQuery.prototype.reobserveAsConcast = function (newOptions, newNetworkStatus) {\n    var _this = this;\n    this.isTornDown = false;\n    var useDisposableConcast = newNetworkStatus === NetworkStatus.refetch || newNetworkStatus === NetworkStatus.fetchMore || newNetworkStatus === NetworkStatus.poll;\n    var oldVariables = this.options.variables;\n    var oldFetchPolicy = this.options.fetchPolicy;\n    var mergedOptions = compact(this.options, newOptions || {});\n    var options = useDisposableConcast ? mergedOptions : assign(this.options, mergedOptions);\n    var query = this.transformDocument(options.query);\n    this.lastQuery = query;\n    if (!useDisposableConcast) {\n      this.updatePolling();\n      if (newOptions && newOptions.variables && !equal(newOptions.variables, oldVariables) && options.fetchPolicy !== \"standby\" && options.fetchPolicy === oldFetchPolicy) {\n        this.applyNextFetchPolicy(\"variables-changed\", options);\n        if (newNetworkStatus === void 0) {\n          newNetworkStatus = NetworkStatus.setVariables;\n        }\n      }\n    }\n    var fetchOptions = query === options.query ? options : __assign(__assign({}, options), {\n      query: query\n    });\n    this.waitForOwnResult && (this.waitForOwnResult = skipCacheDataFor(fetchOptions.fetchPolicy));\n    var finishWaitingForOwnResult = function () {\n      if (_this.concast === concast) {\n        _this.waitForOwnResult = false;\n      }\n    };\n    var variables = fetchOptions.variables && __assign({}, fetchOptions.variables);\n    var _a = this.fetch(fetchOptions, newNetworkStatus),\n      concast = _a.concast,\n      fromLink = _a.fromLink;\n    var observer = {\n      next: function (result) {\n        finishWaitingForOwnResult();\n        _this.reportResult(result, variables);\n      },\n      error: function (error) {\n        finishWaitingForOwnResult();\n        _this.reportError(error, variables);\n      }\n    };\n    if (!useDisposableConcast && (fromLink || !this.concast)) {\n      if (this.concast && this.observer) {\n        this.concast.removeObserver(this.observer);\n      }\n      this.concast = concast;\n      this.observer = observer;\n    }\n    concast.addObserver(observer);\n    return concast;\n  };\n  ObservableQuery.prototype.reobserve = function (newOptions, newNetworkStatus) {\n    return this.reobserveAsConcast(newOptions, newNetworkStatus).promise;\n  };\n  ObservableQuery.prototype.observe = function () {\n    this.reportResult(this.getCurrentResult(false), this.variables);\n  };\n  ObservableQuery.prototype.reportResult = function (result, variables) {\n    var lastError = this.getLastError();\n    var isDifferent = this.isDifferentFromLastResult(result, variables);\n    if (lastError || !result.partial || this.options.returnPartialData) {\n      this.updateLastResult(result, variables);\n    }\n    if (lastError || isDifferent) {\n      iterateObserversSafely(this.observers, \"next\", result);\n    }\n  };\n  ObservableQuery.prototype.reportError = function (error, variables) {\n    var errorResult = __assign(__assign({}, this.getLastResult()), {\n      error: error,\n      errors: error.graphQLErrors,\n      networkStatus: NetworkStatus.error,\n      loading: false\n    });\n    this.updateLastResult(errorResult, variables);\n    iterateObserversSafely(this.observers, 'error', this.last.error = error);\n  };\n  ObservableQuery.prototype.hasObservers = function () {\n    return this.observers.size > 0;\n  };\n  ObservableQuery.prototype.tearDownQuery = function () {\n    if (this.isTornDown) return;\n    if (this.concast && this.observer) {\n      this.concast.removeObserver(this.observer);\n      delete this.concast;\n      delete this.observer;\n    }\n    this.stopPolling();\n    this.subscriptions.forEach(function (sub) {\n      return sub.unsubscribe();\n    });\n    this.subscriptions.clear();\n    this.queryManager.stopQuery(this.queryId);\n    this.observers.clear();\n    this.isTornDown = true;\n  };\n  ObservableQuery.prototype.transformDocument = function (document) {\n    return this.queryManager.transform(document);\n  };\n  return ObservableQuery;\n}(Observable);\nexport { ObservableQuery };\nfixObservableSubclass(ObservableQuery);\nexport function reobserveCacheFirst(obsQuery) {\n  var _a = obsQuery.options,\n    fetchPolicy = _a.fetchPolicy,\n    nextFetchPolicy = _a.nextFetchPolicy;\n  if (fetchPolicy === \"cache-and-network\" || fetchPolicy === \"network-only\") {\n    return obsQuery.reobserve({\n      fetchPolicy: \"cache-first\",\n      nextFetchPolicy: function () {\n        this.nextFetchPolicy = nextFetchPolicy;\n        if (typeof nextFetchPolicy === \"function\") {\n          return nextFetchPolicy.apply(this, arguments);\n        }\n        return fetchPolicy;\n      }\n    });\n  }\n  return obsQuery.reobserve();\n}\nfunction defaultSubscriptionObserverErrorCallback(error) {\n  globalThis.__DEV__ !== false && invariant.error(21, error.message, error.stack);\n}\nexport function logMissingFieldErrors(missing) {\n  if (globalThis.__DEV__ !== false && missing) {\n    globalThis.__DEV__ !== false && invariant.debug(22, missing);\n  }\n}\nfunction skipCacheDataFor(fetchPolicy) {\n  return fetchPolicy === \"network-only\" || fetchPolicy === \"no-cache\" || fetchPolicy === \"standby\";\n}","map":{"version":3,"names":["__assign","__extends","invariant","equal","NetworkStatus","isNetworkRequestInFlight","cloneDeep","compact","getOperationDefinition","Observable","iterateObserversSafely","fixObservableSubclass","getQueryDefinition","equalByQuery","assign","Object","hasOwnProperty","ObservableQuery","_super","_a","queryManager","queryInfo","options","_this","call","observer","subObserver","_subscription","_observer","error","defaultSubscriptionObserverErrorCallback","first","observers","size","add","last","result","next","reobserve","catch","delete","tearDownQuery","Set","subscriptions","waitForOwnResult","skipCacheDataFor","fetchPolicy","isTornDown","_b","defaultOptions","watchQuery","_c","_d","defaultFetchPolicy","_e","_f","initialFetchPolicy","queryId","generateQueryId","opDef","query","queryName","name","value","defineProperty","prototype","get","lastQuery","enumerable","configurable","variables","Promise","resolve","reject","removeQuery","setTimeout","subscription","unsubscribe","subscribe","getCurrentResult","saveAsLastResult","lastResult","getLastResult","networkStatus","ready","loading","getDocumentInfo","hasForcedResolvers","diff","getDiff","complete","returnPartialData","data","partial","globalThis","__DEV__","partialRefetch","logMissingFieldErrors","missing","updateLastResult","isDifferentFromLastResult","newResult","resultIsDifferent","hasNonreactiveDirective","getLast","key","variablesMustMatch","getLastError","resetLastResults","resetQueryStoreErrors","resetErrors","refetch","reobserveOptions","pollInterval","queryDef","vars","variableDefinitions","some","v","variable","warn","resetLastWrite","fetchMore","fetchMoreOptions","combinedOptions","transformDocument","qid","originalNetworkStatus","notifyOnNetworkStatusChange","observe","updatedQuerySet","fetchQuery","then","fetchMoreResult","cache","batch","update","updateQuery","optimistic","previous","writeQuery","onWatchUpdated","watch","finally","has","reobserveCacheFirst","subscribeToMore","startGraphQLSubscription","document","context","subscriptionData","err","onError","setOptions","newOptions","silentSetOptions","mergedOptions","setVariables","mapFn","broadcastQueries","startPolling","updatePolling","stopPolling","applyNextFetchPolicy","reason","nextFetchPolicy","observable","fetch","newNetworkStatus","setObservableQuery","ssrMode","pollingInfo","clearTimeout","timeout","interval","info","maybeFetch","poll","assumeImmutableResults","reobserveAsConcast","useDisposableConcast","oldVariables","oldFetchPolicy","fetchOptions","finishWaitingForOwnResult","concast","fromLink","reportResult","reportError","removeObserver","addObserver","promise","lastError","isDifferent","errorResult","errors","graphQLErrors","hasObservers","forEach","sub","clear","stopQuery","transform","obsQuery","apply","arguments","message","stack","debug"],"sources":["D:/Repos/learn-dotnet/GraphQL_Angular_Subscriptions_V7_6_0/TodoClient/node_modules/@apollo/client/core/ObservableQuery.js"],"sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { invariant } from '../utilities/globals/index.js';\nimport { equal } from '@wry/equality';\nimport { NetworkStatus, isNetworkRequestInFlight } from './networkStatus.js';\nimport { cloneDeep, compact, getOperationDefinition, Observable, iterateObserversSafely, fixObservableSubclass, getQueryDefinition, } from '../utilities/index.js';\nimport { equalByQuery } from './equalByQuery.js';\nvar assign = Object.assign, hasOwnProperty = Object.hasOwnProperty;\nvar ObservableQuery = (function (_super) {\n    __extends(ObservableQuery, _super);\n    function ObservableQuery(_a) {\n        var queryManager = _a.queryManager, queryInfo = _a.queryInfo, options = _a.options;\n        var _this = _super.call(this, function (observer) {\n            try {\n                var subObserver = observer._subscription._observer;\n                if (subObserver && !subObserver.error) {\n                    subObserver.error = defaultSubscriptionObserverErrorCallback;\n                }\n            }\n            catch (_a) { }\n            var first = !_this.observers.size;\n            _this.observers.add(observer);\n            var last = _this.last;\n            if (last && last.error) {\n                observer.error && observer.error(last.error);\n            }\n            else if (last && last.result) {\n                observer.next && observer.next(last.result);\n            }\n            if (first) {\n                _this.reobserve().catch(function () { });\n            }\n            return function () {\n                if (_this.observers.delete(observer) && !_this.observers.size) {\n                    _this.tearDownQuery();\n                }\n            };\n        }) || this;\n        _this.observers = new Set();\n        _this.subscriptions = new Set();\n        _this.queryInfo = queryInfo;\n        _this.queryManager = queryManager;\n        _this.waitForOwnResult = skipCacheDataFor(options.fetchPolicy);\n        _this.isTornDown = false;\n        var _b = queryManager.defaultOptions.watchQuery, _c = _b === void 0 ? {} : _b, _d = _c.fetchPolicy, defaultFetchPolicy = _d === void 0 ? \"cache-first\" : _d;\n        var _e = options.fetchPolicy, fetchPolicy = _e === void 0 ? defaultFetchPolicy : _e, _f = options.initialFetchPolicy, initialFetchPolicy = _f === void 0 ? (fetchPolicy === \"standby\" ? defaultFetchPolicy : fetchPolicy) : _f;\n        _this.options = __assign(__assign({}, options), { initialFetchPolicy: initialFetchPolicy, fetchPolicy: fetchPolicy });\n        _this.queryId = queryInfo.queryId || queryManager.generateQueryId();\n        var opDef = getOperationDefinition(_this.query);\n        _this.queryName = opDef && opDef.name && opDef.name.value;\n        return _this;\n    }\n    Object.defineProperty(ObservableQuery.prototype, \"query\", {\n        get: function () {\n            return this.lastQuery || this.options.query;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ObservableQuery.prototype, \"variables\", {\n        get: function () {\n            return this.options.variables;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ObservableQuery.prototype.result = function () {\n        var _this = this;\n        return new Promise(function (resolve, reject) {\n            var observer = {\n                next: function (result) {\n                    resolve(result);\n                    _this.observers.delete(observer);\n                    if (!_this.observers.size) {\n                        _this.queryManager.removeQuery(_this.queryId);\n                    }\n                    setTimeout(function () {\n                        subscription.unsubscribe();\n                    }, 0);\n                },\n                error: reject,\n            };\n            var subscription = _this.subscribe(observer);\n        });\n    };\n    ObservableQuery.prototype.getCurrentResult = function (saveAsLastResult) {\n        if (saveAsLastResult === void 0) { saveAsLastResult = true; }\n        var lastResult = this.getLastResult(true);\n        var networkStatus = this.queryInfo.networkStatus ||\n            (lastResult && lastResult.networkStatus) ||\n            NetworkStatus.ready;\n        var result = __assign(__assign({}, lastResult), { loading: isNetworkRequestInFlight(networkStatus), networkStatus: networkStatus });\n        var _a = this.options.fetchPolicy, fetchPolicy = _a === void 0 ? \"cache-first\" : _a;\n        if (skipCacheDataFor(fetchPolicy) ||\n            this.queryManager.getDocumentInfo(this.query).hasForcedResolvers) {\n        }\n        else if (this.waitForOwnResult) {\n            this.queryInfo['updateWatch']();\n        }\n        else {\n            var diff = this.queryInfo.getDiff();\n            if (diff.complete || this.options.returnPartialData) {\n                result.data = diff.result;\n            }\n            if (equal(result.data, {})) {\n                result.data = void 0;\n            }\n            if (diff.complete) {\n                delete result.partial;\n                if (diff.complete &&\n                    result.networkStatus === NetworkStatus.loading &&\n                    (fetchPolicy === 'cache-first' ||\n                        fetchPolicy === 'cache-only')) {\n                    result.networkStatus = NetworkStatus.ready;\n                    result.loading = false;\n                }\n            }\n            else {\n                result.partial = true;\n            }\n            if (globalThis.__DEV__ !== false &&\n                !diff.complete &&\n                !this.options.partialRefetch &&\n                !result.loading &&\n                !result.data &&\n                !result.error) {\n                logMissingFieldErrors(diff.missing);\n            }\n        }\n        if (saveAsLastResult) {\n            this.updateLastResult(result);\n        }\n        return result;\n    };\n    ObservableQuery.prototype.isDifferentFromLastResult = function (newResult, variables) {\n        if (!this.last) {\n            return true;\n        }\n        var resultIsDifferent = this.queryManager.getDocumentInfo(this.query).hasNonreactiveDirective\n            ? !equalByQuery(this.query, this.last.result, newResult, this.variables)\n            : !equal(this.last.result, newResult);\n        return (resultIsDifferent ||\n            (variables && !equal(this.last.variables, variables)));\n    };\n    ObservableQuery.prototype.getLast = function (key, variablesMustMatch) {\n        var last = this.last;\n        if (last &&\n            last[key] &&\n            (!variablesMustMatch || equal(last.variables, this.variables))) {\n            return last[key];\n        }\n    };\n    ObservableQuery.prototype.getLastResult = function (variablesMustMatch) {\n        return this.getLast(\"result\", variablesMustMatch);\n    };\n    ObservableQuery.prototype.getLastError = function (variablesMustMatch) {\n        return this.getLast(\"error\", variablesMustMatch);\n    };\n    ObservableQuery.prototype.resetLastResults = function () {\n        delete this.last;\n        this.isTornDown = false;\n    };\n    ObservableQuery.prototype.resetQueryStoreErrors = function () {\n        this.queryManager.resetErrors(this.queryId);\n    };\n    ObservableQuery.prototype.refetch = function (variables) {\n        var _a;\n        var reobserveOptions = {\n            pollInterval: 0,\n        };\n        var fetchPolicy = this.options.fetchPolicy;\n        if (fetchPolicy === 'cache-and-network') {\n            reobserveOptions.fetchPolicy = fetchPolicy;\n        }\n        else if (fetchPolicy === 'no-cache') {\n            reobserveOptions.fetchPolicy = 'no-cache';\n        }\n        else {\n            reobserveOptions.fetchPolicy = 'network-only';\n        }\n        if (globalThis.__DEV__ !== false && variables && hasOwnProperty.call(variables, \"variables\")) {\n            var queryDef = getQueryDefinition(this.query);\n            var vars = queryDef.variableDefinitions;\n            if (!vars || !vars.some(function (v) { return v.variable.name.value === \"variables\"; })) {\n                globalThis.__DEV__ !== false && invariant.warn(\n                    18,\n                    variables,\n                    ((_a = queryDef.name) === null || _a === void 0 ? void 0 : _a.value) || queryDef\n                );\n            }\n        }\n        if (variables && !equal(this.options.variables, variables)) {\n            reobserveOptions.variables = this.options.variables = __assign(__assign({}, this.options.variables), variables);\n        }\n        this.queryInfo.resetLastWrite();\n        return this.reobserve(reobserveOptions, NetworkStatus.refetch);\n    };\n    ObservableQuery.prototype.fetchMore = function (fetchMoreOptions) {\n        var _this = this;\n        var combinedOptions = __assign(__assign({}, (fetchMoreOptions.query ? fetchMoreOptions : __assign(__assign(__assign(__assign({}, this.options), { query: this.options.query }), fetchMoreOptions), { variables: __assign(__assign({}, this.options.variables), fetchMoreOptions.variables) }))), { fetchPolicy: \"no-cache\" });\n        combinedOptions.query = this.transformDocument(combinedOptions.query);\n        var qid = this.queryManager.generateQueryId();\n        this.lastQuery = fetchMoreOptions.query\n            ? this.transformDocument(this.options.query)\n            : combinedOptions.query;\n        var queryInfo = this.queryInfo;\n        var originalNetworkStatus = queryInfo.networkStatus;\n        queryInfo.networkStatus = NetworkStatus.fetchMore;\n        if (combinedOptions.notifyOnNetworkStatusChange) {\n            this.observe();\n        }\n        var updatedQuerySet = new Set();\n        return this.queryManager.fetchQuery(qid, combinedOptions, NetworkStatus.fetchMore).then(function (fetchMoreResult) {\n            _this.queryManager.removeQuery(qid);\n            if (queryInfo.networkStatus === NetworkStatus.fetchMore) {\n                queryInfo.networkStatus = originalNetworkStatus;\n            }\n            _this.queryManager.cache.batch({\n                update: function (cache) {\n                    var updateQuery = fetchMoreOptions.updateQuery;\n                    if (updateQuery) {\n                        cache.updateQuery({\n                            query: _this.query,\n                            variables: _this.variables,\n                            returnPartialData: true,\n                            optimistic: false,\n                        }, function (previous) { return updateQuery(previous, {\n                            fetchMoreResult: fetchMoreResult.data,\n                            variables: combinedOptions.variables,\n                        }); });\n                    }\n                    else {\n                        cache.writeQuery({\n                            query: combinedOptions.query,\n                            variables: combinedOptions.variables,\n                            data: fetchMoreResult.data,\n                        });\n                    }\n                },\n                onWatchUpdated: function (watch) {\n                    updatedQuerySet.add(watch.query);\n                },\n            });\n            return fetchMoreResult;\n        }).finally(function () {\n            if (!updatedQuerySet.has(_this.query)) {\n                reobserveCacheFirst(_this);\n            }\n        });\n    };\n    ObservableQuery.prototype.subscribeToMore = function (options) {\n        var _this = this;\n        var subscription = this.queryManager\n            .startGraphQLSubscription({\n            query: options.document,\n            variables: options.variables,\n            context: options.context,\n        })\n            .subscribe({\n            next: function (subscriptionData) {\n                var updateQuery = options.updateQuery;\n                if (updateQuery) {\n                    _this.updateQuery(function (previous, _a) {\n                        var variables = _a.variables;\n                        return updateQuery(previous, {\n                            subscriptionData: subscriptionData,\n                            variables: variables,\n                        });\n                    });\n                }\n            },\n            error: function (err) {\n                if (options.onError) {\n                    options.onError(err);\n                    return;\n                }\n                globalThis.__DEV__ !== false && invariant.error(19, err);\n            },\n        });\n        this.subscriptions.add(subscription);\n        return function () {\n            if (_this.subscriptions.delete(subscription)) {\n                subscription.unsubscribe();\n            }\n        };\n    };\n    ObservableQuery.prototype.setOptions = function (newOptions) {\n        return this.reobserve(newOptions);\n    };\n    ObservableQuery.prototype.silentSetOptions = function (newOptions) {\n        var mergedOptions = compact(this.options, newOptions || {});\n        assign(this.options, mergedOptions);\n    };\n    ObservableQuery.prototype.setVariables = function (variables) {\n        if (equal(this.variables, variables)) {\n            return this.observers.size\n                ? this.result()\n                : Promise.resolve();\n        }\n        this.options.variables = variables;\n        if (!this.observers.size) {\n            return Promise.resolve();\n        }\n        return this.reobserve({\n            fetchPolicy: this.options.initialFetchPolicy,\n            variables: variables,\n        }, NetworkStatus.setVariables);\n    };\n    ObservableQuery.prototype.updateQuery = function (mapFn) {\n        var queryManager = this.queryManager;\n        var result = queryManager.cache.diff({\n            query: this.options.query,\n            variables: this.variables,\n            returnPartialData: true,\n            optimistic: false,\n        }).result;\n        var newResult = mapFn(result, {\n            variables: this.variables,\n        });\n        if (newResult) {\n            queryManager.cache.writeQuery({\n                query: this.options.query,\n                data: newResult,\n                variables: this.variables,\n            });\n            queryManager.broadcastQueries();\n        }\n    };\n    ObservableQuery.prototype.startPolling = function (pollInterval) {\n        this.options.pollInterval = pollInterval;\n        this.updatePolling();\n    };\n    ObservableQuery.prototype.stopPolling = function () {\n        this.options.pollInterval = 0;\n        this.updatePolling();\n    };\n    ObservableQuery.prototype.applyNextFetchPolicy = function (reason, options) {\n        if (options.nextFetchPolicy) {\n            var _a = options.fetchPolicy, fetchPolicy = _a === void 0 ? \"cache-first\" : _a, _b = options.initialFetchPolicy, initialFetchPolicy = _b === void 0 ? fetchPolicy : _b;\n            if (fetchPolicy === \"standby\") {\n            }\n            else if (typeof options.nextFetchPolicy === \"function\") {\n                options.fetchPolicy = options.nextFetchPolicy(fetchPolicy, {\n                    reason: reason,\n                    options: options,\n                    observable: this,\n                    initialFetchPolicy: initialFetchPolicy,\n                });\n            }\n            else if (reason === \"variables-changed\") {\n                options.fetchPolicy = initialFetchPolicy;\n            }\n            else {\n                options.fetchPolicy = options.nextFetchPolicy;\n            }\n        }\n        return options.fetchPolicy;\n    };\n    ObservableQuery.prototype.fetch = function (options, newNetworkStatus) {\n        this.queryManager.setObservableQuery(this);\n        return this.queryManager['fetchConcastWithInfo'](this.queryId, options, newNetworkStatus);\n    };\n    ObservableQuery.prototype.updatePolling = function () {\n        var _this = this;\n        if (this.queryManager.ssrMode) {\n            return;\n        }\n        var _a = this, pollingInfo = _a.pollingInfo, pollInterval = _a.options.pollInterval;\n        if (!pollInterval) {\n            if (pollingInfo) {\n                clearTimeout(pollingInfo.timeout);\n                delete this.pollingInfo;\n            }\n            return;\n        }\n        if (pollingInfo &&\n            pollingInfo.interval === pollInterval) {\n            return;\n        }\n        invariant(pollInterval, 20);\n        var info = pollingInfo || (this.pollingInfo = {});\n        info.interval = pollInterval;\n        var maybeFetch = function () {\n            if (_this.pollingInfo) {\n                if (!isNetworkRequestInFlight(_this.queryInfo.networkStatus)) {\n                    _this.reobserve({\n                        fetchPolicy: _this.options.initialFetchPolicy === 'no-cache' ? 'no-cache' : 'network-only',\n                    }, NetworkStatus.poll).then(poll, poll);\n                }\n                else {\n                    poll();\n                }\n            }\n            ;\n        };\n        var poll = function () {\n            var info = _this.pollingInfo;\n            if (info) {\n                clearTimeout(info.timeout);\n                info.timeout = setTimeout(maybeFetch, info.interval);\n            }\n        };\n        poll();\n    };\n    ObservableQuery.prototype.updateLastResult = function (newResult, variables) {\n        if (variables === void 0) { variables = this.variables; }\n        var error = this.getLastError();\n        if (error && this.last && !equal(variables, this.last.variables)) {\n            error = void 0;\n        }\n        return this.last = __assign({ result: this.queryManager.assumeImmutableResults\n                ? newResult\n                : cloneDeep(newResult), variables: variables }, (error ? { error: error } : null));\n    };\n    ObservableQuery.prototype.reobserveAsConcast = function (newOptions, newNetworkStatus) {\n        var _this = this;\n        this.isTornDown = false;\n        var useDisposableConcast = newNetworkStatus === NetworkStatus.refetch ||\n            newNetworkStatus === NetworkStatus.fetchMore ||\n            newNetworkStatus === NetworkStatus.poll;\n        var oldVariables = this.options.variables;\n        var oldFetchPolicy = this.options.fetchPolicy;\n        var mergedOptions = compact(this.options, newOptions || {});\n        var options = useDisposableConcast\n            ? mergedOptions\n            : assign(this.options, mergedOptions);\n        var query = this.transformDocument(options.query);\n        this.lastQuery = query;\n        if (!useDisposableConcast) {\n            this.updatePolling();\n            if (newOptions &&\n                newOptions.variables &&\n                !equal(newOptions.variables, oldVariables) &&\n                options.fetchPolicy !== \"standby\" &&\n                options.fetchPolicy === oldFetchPolicy) {\n                this.applyNextFetchPolicy(\"variables-changed\", options);\n                if (newNetworkStatus === void 0) {\n                    newNetworkStatus = NetworkStatus.setVariables;\n                }\n            }\n        }\n        var fetchOptions = query === options.query ? options : __assign(__assign({}, options), { query: query });\n        this.waitForOwnResult && (this.waitForOwnResult = skipCacheDataFor(fetchOptions.fetchPolicy));\n        var finishWaitingForOwnResult = function () {\n            if (_this.concast === concast) {\n                _this.waitForOwnResult = false;\n            }\n        };\n        var variables = fetchOptions.variables && __assign({}, fetchOptions.variables);\n        var _a = this.fetch(fetchOptions, newNetworkStatus), concast = _a.concast, fromLink = _a.fromLink;\n        var observer = {\n            next: function (result) {\n                finishWaitingForOwnResult();\n                _this.reportResult(result, variables);\n            },\n            error: function (error) {\n                finishWaitingForOwnResult();\n                _this.reportError(error, variables);\n            },\n        };\n        if (!useDisposableConcast && (fromLink || !this.concast)) {\n            if (this.concast && this.observer) {\n                this.concast.removeObserver(this.observer);\n            }\n            this.concast = concast;\n            this.observer = observer;\n        }\n        concast.addObserver(observer);\n        return concast;\n    };\n    ObservableQuery.prototype.reobserve = function (newOptions, newNetworkStatus) {\n        return this.reobserveAsConcast(newOptions, newNetworkStatus).promise;\n    };\n    ObservableQuery.prototype.observe = function () {\n        this.reportResult(this.getCurrentResult(false), this.variables);\n    };\n    ObservableQuery.prototype.reportResult = function (result, variables) {\n        var lastError = this.getLastError();\n        var isDifferent = this.isDifferentFromLastResult(result, variables);\n        if (lastError || !result.partial || this.options.returnPartialData) {\n            this.updateLastResult(result, variables);\n        }\n        if (lastError || isDifferent) {\n            iterateObserversSafely(this.observers, \"next\", result);\n        }\n    };\n    ObservableQuery.prototype.reportError = function (error, variables) {\n        var errorResult = __assign(__assign({}, this.getLastResult()), { error: error, errors: error.graphQLErrors, networkStatus: NetworkStatus.error, loading: false });\n        this.updateLastResult(errorResult, variables);\n        iterateObserversSafely(this.observers, 'error', this.last.error = error);\n    };\n    ObservableQuery.prototype.hasObservers = function () {\n        return this.observers.size > 0;\n    };\n    ObservableQuery.prototype.tearDownQuery = function () {\n        if (this.isTornDown)\n            return;\n        if (this.concast && this.observer) {\n            this.concast.removeObserver(this.observer);\n            delete this.concast;\n            delete this.observer;\n        }\n        this.stopPolling();\n        this.subscriptions.forEach(function (sub) { return sub.unsubscribe(); });\n        this.subscriptions.clear();\n        this.queryManager.stopQuery(this.queryId);\n        this.observers.clear();\n        this.isTornDown = true;\n    };\n    ObservableQuery.prototype.transformDocument = function (document) {\n        return this.queryManager.transform(document);\n    };\n    return ObservableQuery;\n}(Observable));\nexport { ObservableQuery };\nfixObservableSubclass(ObservableQuery);\nexport function reobserveCacheFirst(obsQuery) {\n    var _a = obsQuery.options, fetchPolicy = _a.fetchPolicy, nextFetchPolicy = _a.nextFetchPolicy;\n    if (fetchPolicy === \"cache-and-network\" ||\n        fetchPolicy === \"network-only\") {\n        return obsQuery.reobserve({\n            fetchPolicy: \"cache-first\",\n            nextFetchPolicy: function () {\n                this.nextFetchPolicy = nextFetchPolicy;\n                if (typeof nextFetchPolicy === \"function\") {\n                    return nextFetchPolicy.apply(this, arguments);\n                }\n                return fetchPolicy;\n            },\n        });\n    }\n    return obsQuery.reobserve();\n}\nfunction defaultSubscriptionObserverErrorCallback(error) {\n    globalThis.__DEV__ !== false && invariant.error(21, error.message, error.stack);\n}\nexport function logMissingFieldErrors(missing) {\n    if (globalThis.__DEV__ !== false && missing) {\n        globalThis.__DEV__ !== false && invariant.debug(22, missing);\n    }\n}\nfunction skipCacheDataFor(fetchPolicy) {\n    return fetchPolicy === \"network-only\" || fetchPolicy === \"no-cache\" || fetchPolicy === \"standby\";\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}