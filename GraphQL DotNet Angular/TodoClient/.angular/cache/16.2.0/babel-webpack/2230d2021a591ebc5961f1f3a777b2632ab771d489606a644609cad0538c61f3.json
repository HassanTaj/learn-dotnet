{"ast":null,"code":"import { __assign, __extends, __rest } from \"tslib\";\nimport { invariant } from '../../utilities/globals/index.js';\nimport { dep } from 'optimism';\nimport { equal } from '@wry/equality';\nimport { Trie } from '@wry/trie';\nimport { isReference, makeReference, DeepMerger, maybeDeepFreeze, canUseWeakMap, isNonNullObject } from '../../utilities/index.js';\nimport { hasOwn, fieldNameFromStoreName } from './helpers.js';\nvar DELETE = Object.create(null);\nvar delModifier = function () {\n  return DELETE;\n};\nvar INVALIDATE = Object.create(null);\nvar EntityStore = function () {\n  function EntityStore(policies, group) {\n    var _this = this;\n    this.policies = policies;\n    this.group = group;\n    this.data = Object.create(null);\n    this.rootIds = Object.create(null);\n    this.refs = Object.create(null);\n    this.getFieldValue = function (objectOrReference, storeFieldName) {\n      return maybeDeepFreeze(isReference(objectOrReference) ? _this.get(objectOrReference.__ref, storeFieldName) : objectOrReference && objectOrReference[storeFieldName]);\n    };\n    this.canRead = function (objOrRef) {\n      return isReference(objOrRef) ? _this.has(objOrRef.__ref) : typeof objOrRef === \"object\";\n    };\n    this.toReference = function (objOrIdOrRef, mergeIntoStore) {\n      if (typeof objOrIdOrRef === \"string\") {\n        return makeReference(objOrIdOrRef);\n      }\n      if (isReference(objOrIdOrRef)) {\n        return objOrIdOrRef;\n      }\n      var id = _this.policies.identify(objOrIdOrRef)[0];\n      if (id) {\n        var ref = makeReference(id);\n        if (mergeIntoStore) {\n          _this.merge(id, objOrIdOrRef);\n        }\n        return ref;\n      }\n    };\n  }\n  EntityStore.prototype.toObject = function () {\n    return __assign({}, this.data);\n  };\n  EntityStore.prototype.has = function (dataId) {\n    return this.lookup(dataId, true) !== void 0;\n  };\n  EntityStore.prototype.get = function (dataId, fieldName) {\n    this.group.depend(dataId, fieldName);\n    if (hasOwn.call(this.data, dataId)) {\n      var storeObject = this.data[dataId];\n      if (storeObject && hasOwn.call(storeObject, fieldName)) {\n        return storeObject[fieldName];\n      }\n    }\n    if (fieldName === \"__typename\" && hasOwn.call(this.policies.rootTypenamesById, dataId)) {\n      return this.policies.rootTypenamesById[dataId];\n    }\n    if (this instanceof Layer) {\n      return this.parent.get(dataId, fieldName);\n    }\n  };\n  EntityStore.prototype.lookup = function (dataId, dependOnExistence) {\n    if (dependOnExistence) this.group.depend(dataId, \"__exists\");\n    if (hasOwn.call(this.data, dataId)) {\n      return this.data[dataId];\n    }\n    if (this instanceof Layer) {\n      return this.parent.lookup(dataId, dependOnExistence);\n    }\n    if (this.policies.rootTypenamesById[dataId]) {\n      return Object.create(null);\n    }\n  };\n  EntityStore.prototype.merge = function (older, newer) {\n    var _this = this;\n    var dataId;\n    if (isReference(older)) older = older.__ref;\n    if (isReference(newer)) newer = newer.__ref;\n    var existing = typeof older === \"string\" ? this.lookup(dataId = older) : older;\n    var incoming = typeof newer === \"string\" ? this.lookup(dataId = newer) : newer;\n    if (!incoming) return;\n    invariant(typeof dataId === \"string\", 1);\n    var merged = new DeepMerger(storeObjectReconciler).merge(existing, incoming);\n    this.data[dataId] = merged;\n    if (merged !== existing) {\n      delete this.refs[dataId];\n      if (this.group.caching) {\n        var fieldsToDirty_1 = Object.create(null);\n        if (!existing) fieldsToDirty_1.__exists = 1;\n        Object.keys(incoming).forEach(function (storeFieldName) {\n          if (!existing || existing[storeFieldName] !== merged[storeFieldName]) {\n            fieldsToDirty_1[storeFieldName] = 1;\n            var fieldName = fieldNameFromStoreName(storeFieldName);\n            if (fieldName !== storeFieldName && !_this.policies.hasKeyArgs(merged.__typename, fieldName)) {\n              fieldsToDirty_1[fieldName] = 1;\n            }\n            if (merged[storeFieldName] === void 0 && !(_this instanceof Layer)) {\n              delete merged[storeFieldName];\n            }\n          }\n        });\n        if (fieldsToDirty_1.__typename && !(existing && existing.__typename) && this.policies.rootTypenamesById[dataId] === merged.__typename) {\n          delete fieldsToDirty_1.__typename;\n        }\n        Object.keys(fieldsToDirty_1).forEach(function (fieldName) {\n          return _this.group.dirty(dataId, fieldName);\n        });\n      }\n    }\n  };\n  EntityStore.prototype.modify = function (dataId, fields) {\n    var _this = this;\n    var storeObject = this.lookup(dataId);\n    if (storeObject) {\n      var changedFields_1 = Object.create(null);\n      var needToMerge_1 = false;\n      var allDeleted_1 = true;\n      var sharedDetails_1 = {\n        DELETE: DELETE,\n        INVALIDATE: INVALIDATE,\n        isReference: isReference,\n        toReference: this.toReference,\n        canRead: this.canRead,\n        readField: function (fieldNameOrOptions, from) {\n          return _this.policies.readField(typeof fieldNameOrOptions === \"string\" ? {\n            fieldName: fieldNameOrOptions,\n            from: from || makeReference(dataId)\n          } : fieldNameOrOptions, {\n            store: _this\n          });\n        }\n      };\n      Object.keys(storeObject).forEach(function (storeFieldName) {\n        var fieldName = fieldNameFromStoreName(storeFieldName);\n        var fieldValue = storeObject[storeFieldName];\n        if (fieldValue === void 0) return;\n        var modify = typeof fields === \"function\" ? fields : fields[storeFieldName] || fields[fieldName];\n        if (modify) {\n          var newValue = modify === delModifier ? DELETE : modify(maybeDeepFreeze(fieldValue), __assign(__assign({}, sharedDetails_1), {\n            fieldName: fieldName,\n            storeFieldName: storeFieldName,\n            storage: _this.getStorage(dataId, storeFieldName)\n          }));\n          if (newValue === INVALIDATE) {\n            _this.group.dirty(dataId, storeFieldName);\n          } else {\n            if (newValue === DELETE) newValue = void 0;\n            if (newValue !== fieldValue) {\n              changedFields_1[storeFieldName] = newValue;\n              needToMerge_1 = true;\n              fieldValue = newValue;\n            }\n          }\n        }\n        if (fieldValue !== void 0) {\n          allDeleted_1 = false;\n        }\n      });\n      if (needToMerge_1) {\n        this.merge(dataId, changedFields_1);\n        if (allDeleted_1) {\n          if (this instanceof Layer) {\n            this.data[dataId] = void 0;\n          } else {\n            delete this.data[dataId];\n          }\n          this.group.dirty(dataId, \"__exists\");\n        }\n        return true;\n      }\n    }\n    return false;\n  };\n  EntityStore.prototype.delete = function (dataId, fieldName, args) {\n    var _a;\n    var storeObject = this.lookup(dataId);\n    if (storeObject) {\n      var typename = this.getFieldValue(storeObject, \"__typename\");\n      var storeFieldName = fieldName && args ? this.policies.getStoreFieldName({\n        typename: typename,\n        fieldName: fieldName,\n        args: args\n      }) : fieldName;\n      return this.modify(dataId, storeFieldName ? (_a = {}, _a[storeFieldName] = delModifier, _a) : delModifier);\n    }\n    return false;\n  };\n  EntityStore.prototype.evict = function (options, limit) {\n    var evicted = false;\n    if (options.id) {\n      if (hasOwn.call(this.data, options.id)) {\n        evicted = this.delete(options.id, options.fieldName, options.args);\n      }\n      if (this instanceof Layer && this !== limit) {\n        evicted = this.parent.evict(options, limit) || evicted;\n      }\n      if (options.fieldName || evicted) {\n        this.group.dirty(options.id, options.fieldName || \"__exists\");\n      }\n    }\n    return evicted;\n  };\n  EntityStore.prototype.clear = function () {\n    this.replace(null);\n  };\n  EntityStore.prototype.extract = function () {\n    var _this = this;\n    var obj = this.toObject();\n    var extraRootIds = [];\n    this.getRootIdSet().forEach(function (id) {\n      if (!hasOwn.call(_this.policies.rootTypenamesById, id)) {\n        extraRootIds.push(id);\n      }\n    });\n    if (extraRootIds.length) {\n      obj.__META = {\n        extraRootIds: extraRootIds.sort()\n      };\n    }\n    return obj;\n  };\n  EntityStore.prototype.replace = function (newData) {\n    var _this = this;\n    Object.keys(this.data).forEach(function (dataId) {\n      if (!(newData && hasOwn.call(newData, dataId))) {\n        _this.delete(dataId);\n      }\n    });\n    if (newData) {\n      var __META = newData.__META,\n        rest_1 = __rest(newData, [\"__META\"]);\n      Object.keys(rest_1).forEach(function (dataId) {\n        _this.merge(dataId, rest_1[dataId]);\n      });\n      if (__META) {\n        __META.extraRootIds.forEach(this.retain, this);\n      }\n    }\n  };\n  EntityStore.prototype.retain = function (rootId) {\n    return this.rootIds[rootId] = (this.rootIds[rootId] || 0) + 1;\n  };\n  EntityStore.prototype.release = function (rootId) {\n    if (this.rootIds[rootId] > 0) {\n      var count = --this.rootIds[rootId];\n      if (!count) delete this.rootIds[rootId];\n      return count;\n    }\n    return 0;\n  };\n  EntityStore.prototype.getRootIdSet = function (ids) {\n    if (ids === void 0) {\n      ids = new Set();\n    }\n    Object.keys(this.rootIds).forEach(ids.add, ids);\n    if (this instanceof Layer) {\n      this.parent.getRootIdSet(ids);\n    } else {\n      Object.keys(this.policies.rootTypenamesById).forEach(ids.add, ids);\n    }\n    return ids;\n  };\n  EntityStore.prototype.gc = function () {\n    var _this = this;\n    var ids = this.getRootIdSet();\n    var snapshot = this.toObject();\n    ids.forEach(function (id) {\n      if (hasOwn.call(snapshot, id)) {\n        Object.keys(_this.findChildRefIds(id)).forEach(ids.add, ids);\n        delete snapshot[id];\n      }\n    });\n    var idsToRemove = Object.keys(snapshot);\n    if (idsToRemove.length) {\n      var root_1 = this;\n      while (root_1 instanceof Layer) root_1 = root_1.parent;\n      idsToRemove.forEach(function (id) {\n        return root_1.delete(id);\n      });\n    }\n    return idsToRemove;\n  };\n  EntityStore.prototype.findChildRefIds = function (dataId) {\n    if (!hasOwn.call(this.refs, dataId)) {\n      var found_1 = this.refs[dataId] = Object.create(null);\n      var root = this.data[dataId];\n      if (!root) return found_1;\n      var workSet_1 = new Set([root]);\n      workSet_1.forEach(function (obj) {\n        if (isReference(obj)) {\n          found_1[obj.__ref] = true;\n        }\n        if (isNonNullObject(obj)) {\n          Object.keys(obj).forEach(function (key) {\n            var child = obj[key];\n            if (isNonNullObject(child)) {\n              workSet_1.add(child);\n            }\n          });\n        }\n      });\n    }\n    return this.refs[dataId];\n  };\n  EntityStore.prototype.makeCacheKey = function () {\n    return this.group.keyMaker.lookupArray(arguments);\n  };\n  return EntityStore;\n}();\nexport { EntityStore };\nvar CacheGroup = function () {\n  function CacheGroup(caching, parent) {\n    if (parent === void 0) {\n      parent = null;\n    }\n    this.caching = caching;\n    this.parent = parent;\n    this.d = null;\n    this.resetCaching();\n  }\n  CacheGroup.prototype.resetCaching = function () {\n    this.d = this.caching ? dep() : null;\n    this.keyMaker = new Trie(canUseWeakMap);\n  };\n  CacheGroup.prototype.depend = function (dataId, storeFieldName) {\n    if (this.d) {\n      this.d(makeDepKey(dataId, storeFieldName));\n      var fieldName = fieldNameFromStoreName(storeFieldName);\n      if (fieldName !== storeFieldName) {\n        this.d(makeDepKey(dataId, fieldName));\n      }\n      if (this.parent) {\n        this.parent.depend(dataId, storeFieldName);\n      }\n    }\n  };\n  CacheGroup.prototype.dirty = function (dataId, storeFieldName) {\n    if (this.d) {\n      this.d.dirty(makeDepKey(dataId, storeFieldName), storeFieldName === \"__exists\" ? \"forget\" : \"setDirty\");\n    }\n  };\n  return CacheGroup;\n}();\nfunction makeDepKey(dataId, storeFieldName) {\n  return storeFieldName + '#' + dataId;\n}\nexport function maybeDependOnExistenceOfEntity(store, entityId) {\n  if (supportsResultCaching(store)) {\n    store.group.depend(entityId, \"__exists\");\n  }\n}\n(function (EntityStore) {\n  var Root = function (_super) {\n    __extends(Root, _super);\n    function Root(_a) {\n      var policies = _a.policies,\n        _b = _a.resultCaching,\n        resultCaching = _b === void 0 ? true : _b,\n        seed = _a.seed;\n      var _this = _super.call(this, policies, new CacheGroup(resultCaching)) || this;\n      _this.stump = new Stump(_this);\n      _this.storageTrie = new Trie(canUseWeakMap);\n      if (seed) _this.replace(seed);\n      return _this;\n    }\n    Root.prototype.addLayer = function (layerId, replay) {\n      return this.stump.addLayer(layerId, replay);\n    };\n    Root.prototype.removeLayer = function () {\n      return this;\n    };\n    Root.prototype.getStorage = function () {\n      return this.storageTrie.lookupArray(arguments);\n    };\n    return Root;\n  }(EntityStore);\n  EntityStore.Root = Root;\n})(EntityStore || (EntityStore = {}));\nvar Layer = function (_super) {\n  __extends(Layer, _super);\n  function Layer(id, parent, replay, group) {\n    var _this = _super.call(this, parent.policies, group) || this;\n    _this.id = id;\n    _this.parent = parent;\n    _this.replay = replay;\n    _this.group = group;\n    replay(_this);\n    return _this;\n  }\n  Layer.prototype.addLayer = function (layerId, replay) {\n    return new Layer(layerId, this, replay, this.group);\n  };\n  Layer.prototype.removeLayer = function (layerId) {\n    var _this = this;\n    var parent = this.parent.removeLayer(layerId);\n    if (layerId === this.id) {\n      if (this.group.caching) {\n        Object.keys(this.data).forEach(function (dataId) {\n          var ownStoreObject = _this.data[dataId];\n          var parentStoreObject = parent[\"lookup\"](dataId);\n          if (!parentStoreObject) {\n            _this.delete(dataId);\n          } else if (!ownStoreObject) {\n            _this.group.dirty(dataId, \"__exists\");\n            Object.keys(parentStoreObject).forEach(function (storeFieldName) {\n              _this.group.dirty(dataId, storeFieldName);\n            });\n          } else if (ownStoreObject !== parentStoreObject) {\n            Object.keys(ownStoreObject).forEach(function (storeFieldName) {\n              if (!equal(ownStoreObject[storeFieldName], parentStoreObject[storeFieldName])) {\n                _this.group.dirty(dataId, storeFieldName);\n              }\n            });\n          }\n        });\n      }\n      return parent;\n    }\n    if (parent === this.parent) return this;\n    return parent.addLayer(this.id, this.replay);\n  };\n  Layer.prototype.toObject = function () {\n    return __assign(__assign({}, this.parent.toObject()), this.data);\n  };\n  Layer.prototype.findChildRefIds = function (dataId) {\n    var fromParent = this.parent.findChildRefIds(dataId);\n    return hasOwn.call(this.data, dataId) ? __assign(__assign({}, fromParent), _super.prototype.findChildRefIds.call(this, dataId)) : fromParent;\n  };\n  Layer.prototype.getStorage = function () {\n    var p = this.parent;\n    while (p.parent) p = p.parent;\n    return p.getStorage.apply(p, arguments);\n  };\n  return Layer;\n}(EntityStore);\nvar Stump = function (_super) {\n  __extends(Stump, _super);\n  function Stump(root) {\n    return _super.call(this, \"EntityStore.Stump\", root, function () {}, new CacheGroup(root.group.caching, root.group)) || this;\n  }\n  Stump.prototype.removeLayer = function () {\n    return this;\n  };\n  Stump.prototype.merge = function () {\n    return this.parent.merge.apply(this.parent, arguments);\n  };\n  return Stump;\n}(Layer);\nfunction storeObjectReconciler(existingObject, incomingObject, property) {\n  var existingValue = existingObject[property];\n  var incomingValue = incomingObject[property];\n  return equal(existingValue, incomingValue) ? existingValue : incomingValue;\n}\nexport function supportsResultCaching(store) {\n  return !!(store instanceof EntityStore && store.group.caching);\n}","map":{"version":3,"names":["__assign","__extends","__rest","invariant","dep","equal","Trie","isReference","makeReference","DeepMerger","maybeDeepFreeze","canUseWeakMap","isNonNullObject","hasOwn","fieldNameFromStoreName","DELETE","Object","create","delModifier","INVALIDATE","EntityStore","policies","group","_this","data","rootIds","refs","getFieldValue","objectOrReference","storeFieldName","get","__ref","canRead","objOrRef","has","toReference","objOrIdOrRef","mergeIntoStore","id","identify","ref","merge","prototype","toObject","dataId","lookup","fieldName","depend","call","storeObject","rootTypenamesById","Layer","parent","dependOnExistence","older","newer","existing","incoming","merged","storeObjectReconciler","caching","fieldsToDirty_1","__exists","keys","forEach","hasKeyArgs","__typename","dirty","modify","fields","changedFields_1","needToMerge_1","allDeleted_1","sharedDetails_1","readField","fieldNameOrOptions","from","store","fieldValue","newValue","storage","getStorage","delete","args","_a","typename","getStoreFieldName","evict","options","limit","evicted","clear","replace","extract","obj","extraRootIds","getRootIdSet","push","length","__META","sort","newData","rest_1","retain","rootId","release","count","ids","Set","add","gc","snapshot","findChildRefIds","idsToRemove","root_1","found_1","root","workSet_1","key","child","makeCacheKey","keyMaker","lookupArray","arguments","CacheGroup","d","resetCaching","makeDepKey","maybeDependOnExistenceOfEntity","entityId","supportsResultCaching","Root","_super","_b","resultCaching","seed","stump","Stump","storageTrie","addLayer","layerId","replay","removeLayer","ownStoreObject","parentStoreObject","fromParent","p","apply","existingObject","incomingObject","property","existingValue","incomingValue"],"sources":["D:/Repos/learn-dotnet/GraphQL_Angular_Subscriptions_V7_6_0/TodoClient/node_modules/@apollo/client/cache/inmemory/entityStore.js"],"sourcesContent":["import { __assign, __extends, __rest } from \"tslib\";\nimport { invariant } from '../../utilities/globals/index.js';\nimport { dep } from 'optimism';\nimport { equal } from '@wry/equality';\nimport { Trie } from '@wry/trie';\nimport { isReference, makeReference, DeepMerger, maybeDeepFreeze, canUseWeakMap, isNonNullObject, } from '../../utilities/index.js';\nimport { hasOwn, fieldNameFromStoreName } from './helpers.js';\nvar DELETE = Object.create(null);\nvar delModifier = function () { return DELETE; };\nvar INVALIDATE = Object.create(null);\nvar EntityStore = (function () {\n    function EntityStore(policies, group) {\n        var _this = this;\n        this.policies = policies;\n        this.group = group;\n        this.data = Object.create(null);\n        this.rootIds = Object.create(null);\n        this.refs = Object.create(null);\n        this.getFieldValue = function (objectOrReference, storeFieldName) { return maybeDeepFreeze(isReference(objectOrReference)\n            ? _this.get(objectOrReference.__ref, storeFieldName)\n            : objectOrReference && objectOrReference[storeFieldName]); };\n        this.canRead = function (objOrRef) {\n            return isReference(objOrRef)\n                ? _this.has(objOrRef.__ref)\n                : typeof objOrRef === \"object\";\n        };\n        this.toReference = function (objOrIdOrRef, mergeIntoStore) {\n            if (typeof objOrIdOrRef === \"string\") {\n                return makeReference(objOrIdOrRef);\n            }\n            if (isReference(objOrIdOrRef)) {\n                return objOrIdOrRef;\n            }\n            var id = _this.policies.identify(objOrIdOrRef)[0];\n            if (id) {\n                var ref = makeReference(id);\n                if (mergeIntoStore) {\n                    _this.merge(id, objOrIdOrRef);\n                }\n                return ref;\n            }\n        };\n    }\n    EntityStore.prototype.toObject = function () {\n        return __assign({}, this.data);\n    };\n    EntityStore.prototype.has = function (dataId) {\n        return this.lookup(dataId, true) !== void 0;\n    };\n    EntityStore.prototype.get = function (dataId, fieldName) {\n        this.group.depend(dataId, fieldName);\n        if (hasOwn.call(this.data, dataId)) {\n            var storeObject = this.data[dataId];\n            if (storeObject && hasOwn.call(storeObject, fieldName)) {\n                return storeObject[fieldName];\n            }\n        }\n        if (fieldName === \"__typename\" &&\n            hasOwn.call(this.policies.rootTypenamesById, dataId)) {\n            return this.policies.rootTypenamesById[dataId];\n        }\n        if (this instanceof Layer) {\n            return this.parent.get(dataId, fieldName);\n        }\n    };\n    EntityStore.prototype.lookup = function (dataId, dependOnExistence) {\n        if (dependOnExistence)\n            this.group.depend(dataId, \"__exists\");\n        if (hasOwn.call(this.data, dataId)) {\n            return this.data[dataId];\n        }\n        if (this instanceof Layer) {\n            return this.parent.lookup(dataId, dependOnExistence);\n        }\n        if (this.policies.rootTypenamesById[dataId]) {\n            return Object.create(null);\n        }\n    };\n    EntityStore.prototype.merge = function (older, newer) {\n        var _this = this;\n        var dataId;\n        if (isReference(older))\n            older = older.__ref;\n        if (isReference(newer))\n            newer = newer.__ref;\n        var existing = typeof older === \"string\"\n            ? this.lookup(dataId = older)\n            : older;\n        var incoming = typeof newer === \"string\"\n            ? this.lookup(dataId = newer)\n            : newer;\n        if (!incoming)\n            return;\n        invariant(typeof dataId === \"string\", 1);\n        var merged = new DeepMerger(storeObjectReconciler).merge(existing, incoming);\n        this.data[dataId] = merged;\n        if (merged !== existing) {\n            delete this.refs[dataId];\n            if (this.group.caching) {\n                var fieldsToDirty_1 = Object.create(null);\n                if (!existing)\n                    fieldsToDirty_1.__exists = 1;\n                Object.keys(incoming).forEach(function (storeFieldName) {\n                    if (!existing || existing[storeFieldName] !== merged[storeFieldName]) {\n                        fieldsToDirty_1[storeFieldName] = 1;\n                        var fieldName = fieldNameFromStoreName(storeFieldName);\n                        if (fieldName !== storeFieldName &&\n                            !_this.policies.hasKeyArgs(merged.__typename, fieldName)) {\n                            fieldsToDirty_1[fieldName] = 1;\n                        }\n                        if (merged[storeFieldName] === void 0 && !(_this instanceof Layer)) {\n                            delete merged[storeFieldName];\n                        }\n                    }\n                });\n                if (fieldsToDirty_1.__typename &&\n                    !(existing && existing.__typename) &&\n                    this.policies.rootTypenamesById[dataId] === merged.__typename) {\n                    delete fieldsToDirty_1.__typename;\n                }\n                Object.keys(fieldsToDirty_1).forEach(function (fieldName) { return _this.group.dirty(dataId, fieldName); });\n            }\n        }\n    };\n    EntityStore.prototype.modify = function (dataId, fields) {\n        var _this = this;\n        var storeObject = this.lookup(dataId);\n        if (storeObject) {\n            var changedFields_1 = Object.create(null);\n            var needToMerge_1 = false;\n            var allDeleted_1 = true;\n            var sharedDetails_1 = {\n                DELETE: DELETE,\n                INVALIDATE: INVALIDATE,\n                isReference: isReference,\n                toReference: this.toReference,\n                canRead: this.canRead,\n                readField: function (fieldNameOrOptions, from) { return _this.policies.readField(typeof fieldNameOrOptions === \"string\" ? {\n                    fieldName: fieldNameOrOptions,\n                    from: from || makeReference(dataId),\n                } : fieldNameOrOptions, { store: _this }); },\n            };\n            Object.keys(storeObject).forEach(function (storeFieldName) {\n                var fieldName = fieldNameFromStoreName(storeFieldName);\n                var fieldValue = storeObject[storeFieldName];\n                if (fieldValue === void 0)\n                    return;\n                var modify = typeof fields === \"function\"\n                    ? fields\n                    : fields[storeFieldName] || fields[fieldName];\n                if (modify) {\n                    var newValue = modify === delModifier ? DELETE :\n                        modify(maybeDeepFreeze(fieldValue), __assign(__assign({}, sharedDetails_1), { fieldName: fieldName, storeFieldName: storeFieldName, storage: _this.getStorage(dataId, storeFieldName) }));\n                    if (newValue === INVALIDATE) {\n                        _this.group.dirty(dataId, storeFieldName);\n                    }\n                    else {\n                        if (newValue === DELETE)\n                            newValue = void 0;\n                        if (newValue !== fieldValue) {\n                            changedFields_1[storeFieldName] = newValue;\n                            needToMerge_1 = true;\n                            fieldValue = newValue;\n                        }\n                    }\n                }\n                if (fieldValue !== void 0) {\n                    allDeleted_1 = false;\n                }\n            });\n            if (needToMerge_1) {\n                this.merge(dataId, changedFields_1);\n                if (allDeleted_1) {\n                    if (this instanceof Layer) {\n                        this.data[dataId] = void 0;\n                    }\n                    else {\n                        delete this.data[dataId];\n                    }\n                    this.group.dirty(dataId, \"__exists\");\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    EntityStore.prototype.delete = function (dataId, fieldName, args) {\n        var _a;\n        var storeObject = this.lookup(dataId);\n        if (storeObject) {\n            var typename = this.getFieldValue(storeObject, \"__typename\");\n            var storeFieldName = fieldName && args\n                ? this.policies.getStoreFieldName({ typename: typename, fieldName: fieldName, args: args })\n                : fieldName;\n            return this.modify(dataId, storeFieldName ? (_a = {},\n                _a[storeFieldName] = delModifier,\n                _a) : delModifier);\n        }\n        return false;\n    };\n    EntityStore.prototype.evict = function (options, limit) {\n        var evicted = false;\n        if (options.id) {\n            if (hasOwn.call(this.data, options.id)) {\n                evicted = this.delete(options.id, options.fieldName, options.args);\n            }\n            if (this instanceof Layer && this !== limit) {\n                evicted = this.parent.evict(options, limit) || evicted;\n            }\n            if (options.fieldName || evicted) {\n                this.group.dirty(options.id, options.fieldName || \"__exists\");\n            }\n        }\n        return evicted;\n    };\n    EntityStore.prototype.clear = function () {\n        this.replace(null);\n    };\n    EntityStore.prototype.extract = function () {\n        var _this = this;\n        var obj = this.toObject();\n        var extraRootIds = [];\n        this.getRootIdSet().forEach(function (id) {\n            if (!hasOwn.call(_this.policies.rootTypenamesById, id)) {\n                extraRootIds.push(id);\n            }\n        });\n        if (extraRootIds.length) {\n            obj.__META = { extraRootIds: extraRootIds.sort() };\n        }\n        return obj;\n    };\n    EntityStore.prototype.replace = function (newData) {\n        var _this = this;\n        Object.keys(this.data).forEach(function (dataId) {\n            if (!(newData && hasOwn.call(newData, dataId))) {\n                _this.delete(dataId);\n            }\n        });\n        if (newData) {\n            var __META = newData.__META, rest_1 = __rest(newData, [\"__META\"]);\n            Object.keys(rest_1).forEach(function (dataId) {\n                _this.merge(dataId, rest_1[dataId]);\n            });\n            if (__META) {\n                __META.extraRootIds.forEach(this.retain, this);\n            }\n        }\n    };\n    EntityStore.prototype.retain = function (rootId) {\n        return this.rootIds[rootId] = (this.rootIds[rootId] || 0) + 1;\n    };\n    EntityStore.prototype.release = function (rootId) {\n        if (this.rootIds[rootId] > 0) {\n            var count = --this.rootIds[rootId];\n            if (!count)\n                delete this.rootIds[rootId];\n            return count;\n        }\n        return 0;\n    };\n    EntityStore.prototype.getRootIdSet = function (ids) {\n        if (ids === void 0) { ids = new Set(); }\n        Object.keys(this.rootIds).forEach(ids.add, ids);\n        if (this instanceof Layer) {\n            this.parent.getRootIdSet(ids);\n        }\n        else {\n            Object.keys(this.policies.rootTypenamesById).forEach(ids.add, ids);\n        }\n        return ids;\n    };\n    EntityStore.prototype.gc = function () {\n        var _this = this;\n        var ids = this.getRootIdSet();\n        var snapshot = this.toObject();\n        ids.forEach(function (id) {\n            if (hasOwn.call(snapshot, id)) {\n                Object.keys(_this.findChildRefIds(id)).forEach(ids.add, ids);\n                delete snapshot[id];\n            }\n        });\n        var idsToRemove = Object.keys(snapshot);\n        if (idsToRemove.length) {\n            var root_1 = this;\n            while (root_1 instanceof Layer)\n                root_1 = root_1.parent;\n            idsToRemove.forEach(function (id) { return root_1.delete(id); });\n        }\n        return idsToRemove;\n    };\n    EntityStore.prototype.findChildRefIds = function (dataId) {\n        if (!hasOwn.call(this.refs, dataId)) {\n            var found_1 = this.refs[dataId] = Object.create(null);\n            var root = this.data[dataId];\n            if (!root)\n                return found_1;\n            var workSet_1 = new Set([root]);\n            workSet_1.forEach(function (obj) {\n                if (isReference(obj)) {\n                    found_1[obj.__ref] = true;\n                }\n                if (isNonNullObject(obj)) {\n                    Object.keys(obj).forEach(function (key) {\n                        var child = obj[key];\n                        if (isNonNullObject(child)) {\n                            workSet_1.add(child);\n                        }\n                    });\n                }\n            });\n        }\n        return this.refs[dataId];\n    };\n    EntityStore.prototype.makeCacheKey = function () {\n        return this.group.keyMaker.lookupArray(arguments);\n    };\n    return EntityStore;\n}());\nexport { EntityStore };\nvar CacheGroup = (function () {\n    function CacheGroup(caching, parent) {\n        if (parent === void 0) { parent = null; }\n        this.caching = caching;\n        this.parent = parent;\n        this.d = null;\n        this.resetCaching();\n    }\n    CacheGroup.prototype.resetCaching = function () {\n        this.d = this.caching ? dep() : null;\n        this.keyMaker = new Trie(canUseWeakMap);\n    };\n    CacheGroup.prototype.depend = function (dataId, storeFieldName) {\n        if (this.d) {\n            this.d(makeDepKey(dataId, storeFieldName));\n            var fieldName = fieldNameFromStoreName(storeFieldName);\n            if (fieldName !== storeFieldName) {\n                this.d(makeDepKey(dataId, fieldName));\n            }\n            if (this.parent) {\n                this.parent.depend(dataId, storeFieldName);\n            }\n        }\n    };\n    CacheGroup.prototype.dirty = function (dataId, storeFieldName) {\n        if (this.d) {\n            this.d.dirty(makeDepKey(dataId, storeFieldName), storeFieldName === \"__exists\" ? \"forget\" : \"setDirty\");\n        }\n    };\n    return CacheGroup;\n}());\nfunction makeDepKey(dataId, storeFieldName) {\n    return storeFieldName + '#' + dataId;\n}\nexport function maybeDependOnExistenceOfEntity(store, entityId) {\n    if (supportsResultCaching(store)) {\n        store.group.depend(entityId, \"__exists\");\n    }\n}\n(function (EntityStore) {\n    var Root = (function (_super) {\n        __extends(Root, _super);\n        function Root(_a) {\n            var policies = _a.policies, _b = _a.resultCaching, resultCaching = _b === void 0 ? true : _b, seed = _a.seed;\n            var _this = _super.call(this, policies, new CacheGroup(resultCaching)) || this;\n            _this.stump = new Stump(_this);\n            _this.storageTrie = new Trie(canUseWeakMap);\n            if (seed)\n                _this.replace(seed);\n            return _this;\n        }\n        Root.prototype.addLayer = function (layerId, replay) {\n            return this.stump.addLayer(layerId, replay);\n        };\n        Root.prototype.removeLayer = function () {\n            return this;\n        };\n        Root.prototype.getStorage = function () {\n            return this.storageTrie.lookupArray(arguments);\n        };\n        return Root;\n    }(EntityStore));\n    EntityStore.Root = Root;\n})(EntityStore || (EntityStore = {}));\nvar Layer = (function (_super) {\n    __extends(Layer, _super);\n    function Layer(id, parent, replay, group) {\n        var _this = _super.call(this, parent.policies, group) || this;\n        _this.id = id;\n        _this.parent = parent;\n        _this.replay = replay;\n        _this.group = group;\n        replay(_this);\n        return _this;\n    }\n    Layer.prototype.addLayer = function (layerId, replay) {\n        return new Layer(layerId, this, replay, this.group);\n    };\n    Layer.prototype.removeLayer = function (layerId) {\n        var _this = this;\n        var parent = this.parent.removeLayer(layerId);\n        if (layerId === this.id) {\n            if (this.group.caching) {\n                Object.keys(this.data).forEach(function (dataId) {\n                    var ownStoreObject = _this.data[dataId];\n                    var parentStoreObject = parent[\"lookup\"](dataId);\n                    if (!parentStoreObject) {\n                        _this.delete(dataId);\n                    }\n                    else if (!ownStoreObject) {\n                        _this.group.dirty(dataId, \"__exists\");\n                        Object.keys(parentStoreObject).forEach(function (storeFieldName) {\n                            _this.group.dirty(dataId, storeFieldName);\n                        });\n                    }\n                    else if (ownStoreObject !== parentStoreObject) {\n                        Object.keys(ownStoreObject).forEach(function (storeFieldName) {\n                            if (!equal(ownStoreObject[storeFieldName], parentStoreObject[storeFieldName])) {\n                                _this.group.dirty(dataId, storeFieldName);\n                            }\n                        });\n                    }\n                });\n            }\n            return parent;\n        }\n        if (parent === this.parent)\n            return this;\n        return parent.addLayer(this.id, this.replay);\n    };\n    Layer.prototype.toObject = function () {\n        return __assign(__assign({}, this.parent.toObject()), this.data);\n    };\n    Layer.prototype.findChildRefIds = function (dataId) {\n        var fromParent = this.parent.findChildRefIds(dataId);\n        return hasOwn.call(this.data, dataId) ? __assign(__assign({}, fromParent), _super.prototype.findChildRefIds.call(this, dataId)) : fromParent;\n    };\n    Layer.prototype.getStorage = function () {\n        var p = this.parent;\n        while (p.parent)\n            p = p.parent;\n        return p.getStorage.apply(p, arguments);\n    };\n    return Layer;\n}(EntityStore));\nvar Stump = (function (_super) {\n    __extends(Stump, _super);\n    function Stump(root) {\n        return _super.call(this, \"EntityStore.Stump\", root, function () { }, new CacheGroup(root.group.caching, root.group)) || this;\n    }\n    Stump.prototype.removeLayer = function () {\n        return this;\n    };\n    Stump.prototype.merge = function () {\n        return this.parent.merge.apply(this.parent, arguments);\n    };\n    return Stump;\n}(Layer));\nfunction storeObjectReconciler(existingObject, incomingObject, property) {\n    var existingValue = existingObject[property];\n    var incomingValue = incomingObject[property];\n    return equal(existingValue, incomingValue) ? existingValue : incomingValue;\n}\nexport function supportsResultCaching(store) {\n    return !!(store instanceof EntityStore && store.group.caching);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}